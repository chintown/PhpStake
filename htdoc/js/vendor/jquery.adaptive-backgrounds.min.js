;(function(e){var t="data-ab-color";var n="data-ab-parent";var r="data-ab-css-background";var i="ab-color-found";var s={selector:'[data-adaptive-background="1"]',parent:null,exclude:["rgb(0,0,0)","rgba(255,255,255)"],normalizeTextColor:false,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};!function(e){"use strict";var t=function(){return document.createElement("canvas").getContext("2d")},n=function(e,n){var r=new Image,i=e.src||e;"data:"!==i.substring(0,5)&&(r.crossOrigin="Anonymous"),r.onload=function(){var e=t("2d");e.drawImage(r,0,0);var i=e.getImageData(0,0,r.width,r.height);n&&n(i.data)},r.src=i},r=function(e){return["rgb(",e,")"].join("")},i=function(e){return e.map(function(e){return r(e.name)})},s=5,o=10,u={};u.colors=function(e,t){t=t||{};var u=t.exclude||[],f=t.paletteSize||o;n(e,function(n){for(var o=e.width*e.height||n.length,l={},h="",p=[],d={dominant:{name:"",count:0},palette:Array.apply(null,new Array(f)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},v=0;o>v;){if(p[0]=n[v],p[1]=n[v+1],p[2]=n[v+2],h=p.join(","),l[h]=h in l?l[h]+1:1,-1===u.indexOf(r(h))){var m=l[h];m>d.dominant.count?(d.dominant.name=h,d.dominant.count=m):d.palette.some(function(e){return m>e.count?(e.name=h,e.count=m,!0):void 0})}v+=4*s}if(t.success){var g=i(d.palette);t.success({dominant:r(d.dominant.name),secondary:g[0],palette:g})}})},e.RGBaster=e.RGBaster||u}(window);e.adaptiveBackground={run:function(o){var u=e.extend({},s,o);e(u.selector).each(function(s,o){var a=e(this);var f=function(){var e=l()?c():a[0];RGBaster.colors(e,{paletteSize:20,exclude:u.exclude,success:function(e){a.attr(t,e.dominant);a.trigger(i,{color:e.dominant,palette:e.palette})}})};var l=function(){return a.attr(r)};var c=function(){return a.css("background-image").replace("url(","").replace(")","")};a.on(i,function(e,t){var r;if(u.parent&&a.parents(u.parent).length){r=a.parents(u.parent)}else if(a.attr(n)&&a.parents(a.attr(n)).length){r=a.parents(a.attr(n))}else if(l()){r=a}else if(u.parent){r=a.parents(u.parent)}else{r=a.parent()}r.css({backgroundColor:t.color});var i=function(e){var n=t.color.match(/\d+/g);return(n[0]*299+n[1]*587+n[2]*114)/1e3};var s=function(e){return i(e)>=128?u.normalizedTextColors.dark:u.normalizedTextColors.light};var o=function(e){return i(e)<=128?u.lumaClasses.dark:u.lumaClasses.light};if(u.normalizeTextColor)r.css({color:s(t.color)});r.addClass(o(t.color)).attr("data-ab-yaq",i(t.color));u.success&&u.success(a,t)});f()})}}})(jQuery);